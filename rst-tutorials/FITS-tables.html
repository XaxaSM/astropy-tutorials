<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="filterTutorials, filterFits, filterFileInputOutput, filterTable, filterNumpy, filterMatplotlib, filterHistogram" name="keywords" />
<meta content="filterTutorials," name="keywords" />

    <title>Viewing and manipulating data from FITS tables &#8212; astropy-tutorials v3.0.dev</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap_sandstone.css" />
    <link rel="stylesheet" type="text/css" href="../_static/astropy.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/jquery-1.11.0.min.js"></script>
    <script src="../_static/js/jquery-fix.js"></script>
    <script src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script src="../_static/bootstrap-sphinx.js"></script>
    <script src="../_static/searchtools.js"></script>
    <script src="https://use.fontawesome.com/3168e95f94.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="shortcut icon" href="../_static/astropy_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <script type="text/javascript">
    jQuery(function() { Search.loadIndex("../searchindex.js"); });
  </script>
  
  <script type="text/javascript" id="searchindexloader"></script>
   

  </head><body>


<nav class="navbar navbar-expand-lg bg-navbar">
  <a class="navbar-brand" href="/" style="padding: 0px 5px;">
    <img src="../../_static/astropy_logo.png" onerror="this.onerror=null;this.src='../_static/astropy_logo.png';" style="height: 38px;">
  </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarColor01">
    <ul class="navbar-nav ml-auto">
      <li class="nav-item active">
        <a class="nav-link" href="http://www.astropy.org"/>Astropy<span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Modules</a>
      </li>
    </ul>
    <form class="form-inline my-2 my-lg-0" action="../search.html" method="get">
      <div class="input-group-prepend">
          <button class="input-group-text" style="padding: 0.7rem"><i class="fa fa-search fa-fw"></i></button>
      </div>
      <input class="form-control mr-sm-3" name="q" type="text" placeholder="Search the universe" />
    </form>
  </div>
</nav>


<div class="container">
  <div class="row">

    
    
    

    
    <div class="col-md-3">
      <div id="sidebar" class="bs-sidenav card" role="complementary">
        <h3>Table of contents</h3>
        <ul>
<li><a class="reference internal" href="#">Viewing and manipulating data from FITS tables</a><ul>
<li><a class="reference internal" href="#authors">Authors</a></li>
<li><a class="reference internal" href="#learning-goals">Learning Goals</a></li>
<li><a class="reference internal" href="#keywords">Keywords</a></li>
<li><a class="reference internal" href="#summary">Summary</a></li>
<li><a class="reference internal" href="#opening-the-fits-file-and-viewing-table-contents">Opening the FITS file and viewing table contents</a></li>
<li><a class="reference internal" href="#making-a-2d-histogram-with-some-table-data">Making a 2D histogram with some table data</a><ul>
<li><a class="reference internal" href="#method-1-use-numpy-to-make-a-2d-histogram-and-imshow-to-display-it">Method 1: Use numpy to make a 2D histogram and imshow to display it</a></li>
<li><a class="reference internal" href="#method-2-use-hist2d-with-a-log-normal-color-scheme">Method 2: Use hist2d with a log-normal color scheme</a></li>
</ul>
</li>
<li><a class="reference internal" href="#close-the-fits-file">Close the FITS file</a></li>
<li><a class="reference internal" href="#exercises">Exercises</a></li>
</ul>
</li>
</ul>

      </div>
    </div>
    

    <div class="col-md-9">
      <div class="content-padding card">
        <div>
  <a href="../_static/FITS-tables/FITS-tables.ipynb"><button id="download">Download tutorial notebook</button></a>
<a href="https://beta.mybinder.org/v2/gh/astropy/astropy-tutorials/main?filepath=/tutorials/notebooks/FITS-tables/FITS-tables.ipynb"><button id="binder">Interactive tutorial notebook</button></a>

<div id="spacer"></div><section id="viewing-and-manipulating-data-from-fits-tables">
<span id="fits-tables"></span><h1>Viewing and manipulating data from FITS tables<a class="headerlink" href="#viewing-and-manipulating-data-from-fits-tables" title="Permalink to this headline">¶</a></h1>
<section id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h2>
<p>Lia Corrales, Kris Stern</p>
</section>
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Download a FITS table file from a URL</p></li>
<li><p>Open a FITS table file and view table contents</p></li>
<li><p>Make a 2D histogram with the table data</p></li>
<li><p>Close the FITS file after use</p></li>
</ul>
</section>
<section id="keywords">
<h2>Keywords<a class="headerlink" href="#keywords" title="Permalink to this headline">¶</a></h2>
<p>FITS, file input/output, table, numpy, matplotlib, histogram</p>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>This tutorial demonstrates the use of <code class="docutils literal notranslate"><span class="pre">astropy.utils.data</span></code> to download
a data file, then uses <code class="docutils literal notranslate"><span class="pre">astropy.io.fits</span></code> and <code class="docutils literal notranslate"><span class="pre">astropy.table</span></code> to open
the file. Lastly, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> is used to visualize the data as a
histogram.</p>
<p><span class="inputnumrole">In[1]:</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LogNorm</span>

<span class="c1"># Set up matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
<p>The following line is needed to download the example FITS files used in
this tutorial.</p>
<p><span class="inputnumrole">In[2]:</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.utils.data</span> <span class="kn">import</span> <span class="n">download_file</span>
</pre></div>
</div>
<p>FITS files often contain large amounts of multi-dimensional data and
tables.</p>
<p>In this particular example, we’ll open a FITS file from a Chandra
observation of the Galactic Center. The file contains a list of events
with x and y coordinates, energy, and various other pieces of
information.</p>
<p><span class="inputnumrole">In[3]:</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">event_filename</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="s1">&#39;http://data.astropy.org/tutorials/FITS-tables/chandra_events.fits&#39;</span><span class="p">,</span>
                               <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="opening-the-fits-file-and-viewing-table-contents">
<h2>Opening the FITS file and viewing table contents<a class="headerlink" href="#opening-the-fits-file-and-viewing-table-contents" title="Permalink to this headline">¶</a></h2>
<p>Since the file is big, let’s open it with <code class="docutils literal notranslate"><span class="pre">memmap=True</span></code> to prevent RAM
storage issues.</p>
<p><span class="inputnumrole">In[4]:</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hdu_list</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">event_filename</span><span class="p">,</span> <span class="n">memmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="inputnumrole">In[5]:</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hdu_list</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<p><span class="outputnumrole">Out[5]:</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Filename</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">circleci</span><span class="o">/.</span><span class="n">astropy</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">url</span><span class="o">/</span><span class="mi">333246</span><span class="n">bccb141ea3b4e86c49e45bf8d6</span><span class="o">/</span><span class="n">contents</span>
<span class="n">No</span><span class="o">.</span>    <span class="n">Name</span>      <span class="n">Ver</span>    <span class="n">Type</span>      <span class="n">Cards</span>   <span class="n">Dimensions</span>   <span class="n">Format</span>
  <span class="mi">0</span>  <span class="n">PRIMARY</span>       <span class="mi">1</span> <span class="n">PrimaryHDU</span>      <span class="mi">30</span>   <span class="p">()</span>
  <span class="mi">1</span>  <span class="n">EVENTS</span>        <span class="mi">1</span> <span class="n">BinTableHDU</span>    <span class="mi">890</span>   <span class="mi">483964</span><span class="n">R</span> <span class="n">x</span> <span class="mi">19</span><span class="n">C</span>   <span class="p">[</span><span class="mi">1</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="n">I</span><span class="p">,</span> <span class="mi">1</span><span class="n">I</span><span class="p">,</span> <span class="mi">1</span><span class="n">J</span><span class="p">,</span> <span class="mi">1</span><span class="n">I</span><span class="p">,</span> <span class="mi">1</span><span class="n">I</span><span class="p">,</span> <span class="mi">1</span><span class="n">I</span><span class="p">,</span> <span class="mi">1</span><span class="n">I</span><span class="p">,</span> <span class="mi">1</span><span class="n">E</span><span class="p">,</span> <span class="mi">1</span><span class="n">E</span><span class="p">,</span> <span class="mi">1</span><span class="n">E</span><span class="p">,</span> <span class="mi">1</span><span class="n">E</span><span class="p">,</span> <span class="mi">1</span><span class="n">J</span><span class="p">,</span> <span class="mi">1</span><span class="n">J</span><span class="p">,</span> <span class="mi">1</span><span class="n">E</span><span class="p">,</span> <span class="mi">1</span><span class="n">J</span><span class="p">,</span> <span class="mi">1</span><span class="n">I</span><span class="p">,</span> <span class="mi">1</span><span class="n">I</span><span class="p">,</span> <span class="mi">32</span><span class="n">X</span><span class="p">]</span>
  <span class="mi">2</span>  <span class="n">GTI</span>           <span class="mi">3</span> <span class="n">BinTableHDU</span>     <span class="mi">28</span>   <span class="mi">1</span><span class="n">R</span> <span class="n">x</span> <span class="mi">2</span><span class="n">C</span>   <span class="p">[</span><span class="mi">1</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="n">D</span><span class="p">]</span>
  <span class="mi">3</span>  <span class="n">GTI</span>           <span class="mi">2</span> <span class="n">BinTableHDU</span>     <span class="mi">28</span>   <span class="mi">1</span><span class="n">R</span> <span class="n">x</span> <span class="mi">2</span><span class="n">C</span>   <span class="p">[</span><span class="mi">1</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="n">D</span><span class="p">]</span>
  <span class="mi">4</span>  <span class="n">GTI</span>           <span class="mi">1</span> <span class="n">BinTableHDU</span>     <span class="mi">28</span>   <span class="mi">1</span><span class="n">R</span> <span class="n">x</span> <span class="mi">2</span><span class="n">C</span>   <span class="p">[</span><span class="mi">1</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="n">D</span><span class="p">]</span>
  <span class="mi">5</span>  <span class="n">GTI</span>           <span class="mi">0</span> <span class="n">BinTableHDU</span>     <span class="mi">28</span>   <span class="mi">1</span><span class="n">R</span> <span class="n">x</span> <span class="mi">2</span><span class="n">C</span>   <span class="p">[</span><span class="mi">1</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="n">D</span><span class="p">]</span>
  <span class="mi">6</span>  <span class="n">GTI</span>           <span class="mi">6</span> <span class="n">BinTableHDU</span>     <span class="mi">28</span>   <span class="mi">1</span><span class="n">R</span> <span class="n">x</span> <span class="mi">2</span><span class="n">C</span>   <span class="p">[</span><span class="mi">1</span><span class="n">D</span><span class="p">,</span> <span class="mi">1</span><span class="n">D</span><span class="p">]</span>
</pre></div>
</div>
<p>In this case, we’re interested in reading EVENTS, which contains
information about each X-ray photon that hit the detector.</p>
<p>To find out what information the table contains, let’s print the column
names.</p>
<p><span class="inputnumrole">In[6]:</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">hdu_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="outputnumrole">Out[6]:</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ColDefs</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1D&#39;</span><span class="p">;</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;ccd_id&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1I&#39;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;node_id&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1I&#39;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;expno&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1J&#39;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;chipx&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1I&#39;</span><span class="p">;</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;pixel&#39;</span><span class="p">;</span> <span class="n">coord_type</span> <span class="o">=</span> <span class="s1">&#39;CPCX&#39;</span><span class="p">;</span> <span class="n">coord_unit</span> <span class="o">=</span> <span class="s1">&#39;mm&#39;</span><span class="p">;</span> <span class="n">coord_ref_point</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">coord_ref_value</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">coord_inc</span> <span class="o">=</span> <span class="mf">0.023987</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;chipy&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1I&#39;</span><span class="p">;</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;pixel&#39;</span><span class="p">;</span> <span class="n">coord_type</span> <span class="o">=</span> <span class="s1">&#39;CPCY&#39;</span><span class="p">;</span> <span class="n">coord_unit</span> <span class="o">=</span> <span class="s1">&#39;mm&#39;</span><span class="p">;</span> <span class="n">coord_ref_point</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">coord_ref_value</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">coord_inc</span> <span class="o">=</span> <span class="mf">0.023987</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;tdetx&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1I&#39;</span><span class="p">;</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;pixel&#39;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;tdety&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1I&#39;</span><span class="p">;</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;pixel&#39;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;detx&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1E&#39;</span><span class="p">;</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;pixel&#39;</span><span class="p">;</span> <span class="n">coord_type</span> <span class="o">=</span> <span class="s1">&#39;LONG-TAN&#39;</span><span class="p">;</span> <span class="n">coord_unit</span> <span class="o">=</span> <span class="s1">&#39;deg&#39;</span><span class="p">;</span> <span class="n">coord_ref_point</span> <span class="o">=</span> <span class="mf">4096.5</span><span class="p">;</span> <span class="n">coord_ref_value</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">coord_inc</span> <span class="o">=</span> <span class="mf">0.00013666666666667</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;dety&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1E&#39;</span><span class="p">;</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;pixel&#39;</span><span class="p">;</span> <span class="n">coord_type</span> <span class="o">=</span> <span class="s1">&#39;NPOL-TAN&#39;</span><span class="p">;</span> <span class="n">coord_unit</span> <span class="o">=</span> <span class="s1">&#39;deg&#39;</span><span class="p">;</span> <span class="n">coord_ref_point</span> <span class="o">=</span> <span class="mf">4096.5</span><span class="p">;</span> <span class="n">coord_ref_value</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">coord_inc</span> <span class="o">=</span> <span class="mf">0.00013666666666667</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1E&#39;</span><span class="p">;</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;pixel&#39;</span><span class="p">;</span> <span class="n">coord_type</span> <span class="o">=</span> <span class="s1">&#39;RA---TAN&#39;</span><span class="p">;</span> <span class="n">coord_unit</span> <span class="o">=</span> <span class="s1">&#39;deg&#39;</span><span class="p">;</span> <span class="n">coord_ref_point</span> <span class="o">=</span> <span class="mf">4096.5</span><span class="p">;</span> <span class="n">coord_ref_value</span> <span class="o">=</span> <span class="mf">266.41519201128</span><span class="p">;</span> <span class="n">coord_inc</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.00013666666666667</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1E&#39;</span><span class="p">;</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;pixel&#39;</span><span class="p">;</span> <span class="n">coord_type</span> <span class="o">=</span> <span class="s1">&#39;DEC--TAN&#39;</span><span class="p">;</span> <span class="n">coord_unit</span> <span class="o">=</span> <span class="s1">&#39;deg&#39;</span><span class="p">;</span> <span class="n">coord_ref_point</span> <span class="o">=</span> <span class="mf">4096.5</span><span class="p">;</span> <span class="n">coord_ref_value</span> <span class="o">=</span> <span class="o">-</span><span class="mf">29.012248288366</span><span class="p">;</span> <span class="n">coord_inc</span> <span class="o">=</span> <span class="mf">0.00013666666666667</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;pha&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1J&#39;</span><span class="p">;</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;adu&#39;</span><span class="p">;</span> <span class="n">null</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;pha_ro&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1J&#39;</span><span class="p">;</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;adu&#39;</span><span class="p">;</span> <span class="n">null</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;energy&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1E&#39;</span><span class="p">;</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;eV&#39;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;pi&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1J&#39;</span><span class="p">;</span> <span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;chan&#39;</span><span class="p">;</span> <span class="n">null</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;fltgrade&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1I&#39;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;grade&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;1I&#39;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;status&#39;</span><span class="p">;</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;32X&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Now we’ll take this data and convert it into an <a class="reference external" href="http://docs.astropy.org/en/stable/table/">astropy
table</a>. While it’s possible
to access FITS tables directly from the <code class="docutils literal notranslate"><span class="pre">.data</span></code> attribute, using
<a class="reference external" href="http://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table">Table</a>
tends to make a variety of common tasks more convenient.</p>
<p><span class="inputnumrole">In[7]:</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">evt_data</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">hdu_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>For example, a preview of the table is easily viewed by simply running a
cell with the table as the last line:</p>
<p><span class="inputnumrole">In[8]:</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">evt_data</span>
</pre></div>
</div>
<p><span class="outputnumrole">Out[8]:</span></p>
<i>Table length=483964</i>
<table id="table140061597067408" class="table-striped table-bordered table-condensed">
<thead><tr><th>time</th><th>ccd_id</th><th>node_id</th><th>expno</th><th>chipx</th><th>chipy</th><th>tdetx</th><th>tdety</th><th>detx</th><th>dety</th><th>x</th><th>y</th><th>pha</th><th>pha_ro</th><th>energy</th><th>pi</th><th>fltgrade</th><th>grade</th><th>status [32]</th></tr></thead>
<thead><tr><th>float64</th><th>int16</th><th>int16</th><th>int32</th><th>int16</th><th>int16</th><th>int16</th><th>int16</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>int32</th><th>int32</th><th>float32</th><th>int32</th><th>int16</th><th>int16</th><th>bool</th></tr></thead>
<tr><td>238623220.9093583</td><td>3</td><td>3</td><td>68</td><td>920</td><td>8</td><td>5124</td><td>3981</td><td>5095.641</td><td>4138.995</td><td>4168.0723</td><td>5087.772</td><td>3548</td><td>3534</td><td>13874.715</td><td>951</td><td>16</td><td>4</td><td>False .. False</td></tr>
<tr><td>238623220.9093583</td><td>3</td><td>1</td><td>68</td><td>437</td><td>237</td><td>4895</td><td>3498</td><td>4865.567</td><td>4621.1826</td><td>3662.1968</td><td>4915.9336</td><td>667</td><td>629</td><td>2621.1938</td><td>180</td><td>64</td><td>2</td><td>False .. False</td></tr>
<tr><td>238623220.9093583</td><td>3</td><td>2</td><td>68</td><td>719</td><td>289</td><td>4843</td><td>3780</td><td>4814.835</td><td>4340.254</td><td>3935.2207</td><td>4832.552</td><td>3033</td><td>2875</td><td>12119.018</td><td>831</td><td>8</td><td>3</td><td>False .. False</td></tr>
<tr><td>238623220.9093583</td><td>3</td><td>0</td><td>68</td><td>103</td><td>295</td><td>4837</td><td>3164</td><td>4807.3643</td><td>4954.385</td><td>3324.4644</td><td>4897.2754</td><td>831</td><td>773</td><td>3253.0364</td><td>223</td><td>0</td><td>0</td><td>False .. False</td></tr>
<tr><td>238623220.9093583</td><td>3</td><td>1</td><td>68</td><td>498</td><td>314</td><td>4818</td><td>3559</td><td>4788.987</td><td>4560.3276</td><td>3713.6343</td><td>4832.735</td><td>3612</td><td>3439</td><td>14214.382</td><td>974</td><td>64</td><td>2</td><td>False .. False</td></tr>
<tr><td>238623220.9093583</td><td>3</td><td>3</td><td>68</td><td>791</td><td>469</td><td>4663</td><td>3852</td><td>4635.4526</td><td>4268.053</td><td>3985.8496</td><td>4645.93</td><td>500</td><td>438</td><td>1952.7239</td><td>134</td><td>0</td><td>0</td><td>False .. False</td></tr>
<tr><td>238623220.9093583</td><td>3</td><td>3</td><td>68</td><td>894</td><td>839</td><td>4293</td><td>3955</td><td>4266.642</td><td>4165.3203</td><td>4044.5469</td><td>4267.605</td><td>835</td><td>713</td><td>3267.5334</td><td>224</td><td>0</td><td>0</td><td>False .. False</td></tr>
<tr><td>238623220.9093583</td><td>3</td><td>3</td><td>68</td><td>857</td><td>941</td><td>4191</td><td>3918</td><td>4164.815</td><td>4202.2256</td><td>3995.9353</td><td>4170.818</td><td>975</td><td>804</td><td>3817.0366</td><td>262</td><td>0</td><td>0</td><td>False .. False</td></tr>
<tr><td>238623220.9093583</td><td>3</td><td>3</td><td>68</td><td>910</td><td>959</td><td>4173</td><td>3971</td><td>4146.9937</td><td>4149.364</td><td>4046.3376</td><td>4146.9106</td><td>576</td><td>446</td><td>2252.7295</td><td>155</td><td>0</td><td>0</td><td>False .. False</td></tr>
<tr><td>238623220.9093583</td><td>3</td><td>3</td><td>68</td><td>961</td><td>962</td><td>4170</td><td>4022</td><td>4144.1284</td><td>4098.4976</td><td>4096.515</td><td>4138.09</td><td>1572</td><td>1354</td><td>6154.1094</td><td>422</td><td>0</td><td>0</td><td>False .. False</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>238672393.54971933</td><td>1</td><td>3</td><td>15723</td><td>933</td><td>199</td><td>4933</td><td>5040</td><td>4902.907</td><td>3082.4956</td><td>5212.4995</td><td>4766.2295</td><td>1222</td><td>1181</td><td>4819.8286</td><td>331</td><td>0</td><td>0</td><td>False .. False</td></tr>
<tr><td>238672393.54971933</td><td>1</td><td>2</td><td>15723</td><td>596</td><td>412</td><td>4720</td><td>4703</td><td>4691.51</td><td>3418.9893</td><td>4853.5117</td><td>4595.8037</td><td>3142</td><td>3020</td><td>12536.866</td><td>859</td><td>10</td><td>6</td><td>False .. False</td></tr>
<tr><td>238672393.54971933</td><td>1</td><td>3</td><td>15723</td><td>1000</td><td>608</td><td>4524</td><td>5107</td><td>4494.713</td><td>3015.7185</td><td>5230.886</td><td>4353.018</td><td>658</td><td>585</td><td>2599.5652</td><td>179</td><td>0</td><td>0</td><td>False .. False</td></tr>
<tr><td>238672393.54971933</td><td>1</td><td>1</td><td>15723</td><td>270</td><td>917</td><td>4215</td><td>4377</td><td>4188.3325</td><td>3743.5957</td><td>4472.07</td><td>4134.221</td><td>3861</td><td>3463</td><td>15535.768</td><td>1024</td><td>16</td><td>4</td><td>False .. False</td></tr>
<tr><td>238672393.54971933</td><td>1</td><td>0</td><td>15723</td><td>232</td><td>988</td><td>4144</td><td>4339</td><td>4117.6147</td><td>3781.8774</td><td>4425.75</td><td>4068.4873</td><td>1680</td><td>1499</td><td>6653.0815</td><td>456</td><td>0</td><td>0</td><td>False .. False</td></tr>
<tr><td>238672393.59075934</td><td>0</td><td>1</td><td>15723</td><td>366</td><td>103</td><td>3164</td><td>4766</td><td>3140.9048</td><td>3356.3208</td><td>4733.6816</td><td>3048.5664</td><td>3621</td><td>3602</td><td>14362.482</td><td>984</td><td>0</td><td>0</td><td>False .. False</td></tr>
<tr><td>238672393.59075934</td><td>0</td><td>3</td><td>15723</td><td>937</td><td>646</td><td>3707</td><td>4195</td><td>3681.2122</td><td>3925.5452</td><td>4231.8354</td><td>3651.9724</td><td>3717</td><td>3486</td><td>14653.954</td><td>1004</td><td>8</td><td>3</td><td>False .. False</td></tr>
<tr><td>238672393.59075934</td><td>0</td><td>1</td><td>15723</td><td>406</td><td>687</td><td>3748</td><td>4726</td><td>3723.4014</td><td>3396.252</td><td>4762.421</td><td>3631.7224</td><td>1676</td><td>1536</td><td>6652.827</td><td>456</td><td>0</td><td>0</td><td>False .. False</td></tr>
<tr><td>238672393.59075934</td><td>0</td><td>1</td><td>15723</td><td>354</td><td>870</td><td>3931</td><td>4778</td><td>3906.07</td><td>3344.775</td><td>4834.99</td><td>3807.0835</td><td>2436</td><td>2165</td><td>9672.882</td><td>663</td><td>16</td><td>4</td><td>False .. False</td></tr>
<tr><td>238672393.63179934</td><td>6</td><td>1</td><td>15723</td><td>384</td><td>821</td><td>3259</td><td>2523</td><td>3230.9204</td><td>5596.8496</td><td>2519.2202</td><td>3401.0327</td><td>491</td><td>356</td><td>1875.9359</td><td>129</td><td>0</td><td>0</td><td>False .. False</td></tr>
</table><p>We can extract data from the table by referencing the column name. Let’s
try making a histogram for the energy of each photon, which will give us
a sense for the spectrum (folded with the detector’s efficiency).</p>
<p><span class="inputnumrole">In[9]:</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">energy_hist</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">evt_data</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="outputnumrole">Out[9]:</span></p>
<img alt="../_images/FITS-tables_18_0.png" src="../_images/FITS-tables_18_0.png" />
</section>
<section id="making-a-2d-histogram-with-some-table-data">
<h2>Making a 2D histogram with some table data<a class="headerlink" href="#making-a-2d-histogram-with-some-table-data" title="Permalink to this headline">¶</a></h2>
<p>We’ll make an image by binning the x and y coordinates of the events
into a 2D histogram.</p>
<p>This particular observation spans five CCD chips. First, we determine
the events that only fell on the main (ACIS-I) chips, which have number
ids 0, 1, 2, and 3.</p>
<p><span class="inputnumrole">In[10]:</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="n">evt_data</span><span class="p">[</span><span class="s1">&#39;ccd_id&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="outputnumrole">Out[10]:</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">434858</span>
</pre></div>
</div>
<section id="method-1-use-numpy-to-make-a-2d-histogram-and-imshow-to-display-it">
<h3>Method 1: Use numpy to make a 2D histogram and imshow to display it<a class="headerlink" href="#method-1-use-numpy-to-make-a-2d-histogram-and-imshow-to-display-it" title="Permalink to this headline">¶</a></h3>
<p>This method allows us to create an image without stretching:</p>
<p><span class="inputnumrole">In[11]:</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">NBINS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">img_zero</span><span class="p">,</span> <span class="n">yedges</span><span class="p">,</span> <span class="n">xedges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">evt_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="n">ii</span><span class="p">],</span> <span class="n">evt_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="n">ii</span><span class="p">],</span> <span class="n">NBINS</span><span class="p">)</span>

<span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">xedges</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xedges</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">yedges</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yedges</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_zero</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_yarg&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="c1"># To see more color maps</span>
<span class="c1"># http://wiki.scipy.org/Cookbook/Matplotlib/Show_colormaps</span>
</pre></div>
</div>
<p><span class="outputnumrole">Out[11]:</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/FITS-tables_25_1.png" src="../_images/FITS-tables_25_1.png" />
</section>
<section id="method-2-use-hist2d-with-a-log-normal-color-scheme">
<h3>Method 2: Use hist2d with a log-normal color scheme<a class="headerlink" href="#method-2-use-hist2d-with-a-log-normal-color-scheme" title="Permalink to this headline">¶</a></h3>
<p><span class="inputnumrole">In[12]:</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">NBINS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">img_zero_mpl</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist2d</span><span class="p">(</span><span class="n">evt_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="n">ii</span><span class="p">],</span> <span class="n">evt_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="n">ii</span><span class="p">],</span> <span class="n">NBINS</span><span class="p">,</span>
                          <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">())</span>

<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">6.0</span><span class="p">])</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="outputnumrole">Out[12]:</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/FITS-tables_27_1.png" src="../_images/FITS-tables_27_1.png" />
</section>
</section>
<section id="close-the-fits-file">
<h2>Close the FITS file<a class="headerlink" href="#close-the-fits-file" title="Permalink to this headline">¶</a></h2>
<p>When you’re done using a FITS file, it’s often a good idea to close it.
That way you can be sure it won’t continue using up excess memory or
file handles on your computer. (This happens automatically when you
close Python, but you never know how long that might be…)</p>
<p><span class="inputnumrole">In[13]:</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hdu_list</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<p>Make a scatter plot of the same data you histogrammed above. The
<a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.scatter">plt.scatter</a>
function is your friend for this. What are the pros and cons of doing it
this way?</p>
<p><span class="inputnumrole">In[None]:</span></p>
<p>Try the same with the
<a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.hexbin">plt.hexbin</a>
plotting function. Which do you think looks better for this kind of
data?</p>
<p><span class="inputnumrole">In[None]:</span></p>
<p>Choose an energy range to make a slice of the FITS table, then plot it.
How does the image change with different energy ranges?</p>
<p><span class="inputnumrole">In[None]:</span></p>
<div id="spacer"></div>

<a href="../_static/FITS-tables/FITS-tables.ipynb"><button id="download">Download tutorial notebook</button></a>
<a href="https://beta.mybinder.org/v2/gh/astropy/astropy-tutorials/main?filepath=/tutorials/notebooks/FITS-tables/FITS-tables.ipynb"><button id="binder">Interactive tutorial notebook</button></a></section>
</section>

</div>
      </div>
      
    </div>
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.
    &copy; Copyright Astropy.
    </p>
  </div>
</footer>
  </body>
</html>